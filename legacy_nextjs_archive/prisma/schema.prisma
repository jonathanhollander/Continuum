generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
}

// Enums for Heirloom & EQ Features
enum VisualTier {
  TIER_1_HERO      // Cinematic, Monumental Header
  TIER_2_SECTION   // Rich Visuals, Blueprint Style
  TIER_3_CARD      // Standard Card, Icon Driven
  TIER_4_LIST      // Dense, Data Focused
  TIER_5_SECURITY  // Vault Style, Minimalist
}

enum EmotionalContext {
  PROACTIVE_PLANNING // Warm, Gold/Green, "Growth"
  IMMEDIATE_LOSS     // Somber, Slate/Blue, "Comfort"
  EXECUTOR_DUTY      // Crisp, Navy/White, "Clarity"
}

enum AssetType {
  FINANCIAL
  REAL_ESTATE
  DIGITAL
  PHYSICAL
  BUSINESS
  OTHER
}

enum TaskStatus {
  NOT_STARTED
  IN_PROGRESS
  REVIEW_NEEDED
  COMPLETED
  DEFERRED
}

// Core Models
model User {
  id        String   @id @default(cuid())
  clerkId   String   @unique
  email     String   @unique
  firstName String?
  lastName  String?
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relationships
  ownedEstates     Estate[] @relation("Owner")
  exercisingEstates Estate[] @relation("Executor")
}

model Estate {
  id          String   @id @default(cuid())
  name        String
  description String?
  
  // Theme Context
  currentTier  VisualTier       @default(TIER_1_HERO)
  emotionalCtx EmotionalContext @default(PROACTIVE_PLANNING)
  
  // Timestamps
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relationships
  ownerId     String
  owner       User   @relation("Owner", fields: [ownerId], references: [id])
  
  executorId  String?
  executor    User?  @relation("Executor", fields: [executorId], references: [id])
  
  assets      Asset[]
  tasks       Task[]
  contacts    Contact[]
  documents   Document[]
}

model Asset {
  id          String     @id @default(cuid())
  name        String
  value       Decimal?
  type        AssetType
  location    String?
  notes       String?
  
  // JSON Metadata for flexible fields (Account #, Login URL, etc.)
  metadata    Json?      

  // Relationships
  estateId    String
  estate      Estate    @relation(fields: [estateId], references: [id])
  
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Task {
  id          String     @id @default(cuid())
  title       String
  description String?
  status      TaskStatus @default(NOT_STARTED)
  priority    String     @default("Medium") // Critical, High, Medium, Low
  
  dueDate     DateTime?
  completedAt DateTime?
  
  // Relationships
  estateId    String
  estate      Estate    @relation(fields: [estateId], references: [id])
  
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
}

model Contact {
  id           String   @id @default(cuid())
  name         String
  role         String?  // Attorney, CPA, Son, Daughter
  email        String?
  phone        String?
  organization String?
  
  // Relationships
  estateId     String
  estate       Estate   @relation(fields: [estateId], references: [id])
  
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Document {
  id        String   @id @default(cuid())
  title     String
  url       String
  fileType  String?
  
  // Relationships
  estateId  String
  estate    Estate   @relation(fields: [estateId], references: [id])
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Resource {
  id          String   @id @default(cuid())
  title       String
  slug        String   @unique
  content     String   // Markdown content from YAML
  category    String   // e.g., "Immediate Steps", "Financial"
  
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
