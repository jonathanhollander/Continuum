import{g as a}from"./DtJFryUL.js";import{c as s}from"./lbPixqMI.js";const c=()=>{if(typeof localStorage>"u")return[];if(localStorage.getItem("continuum_owner_activity_log"))return[];const e=localStorage.getItem("continuum_activity_log");if(e)try{return JSON.parse(e)}catch(n){console.error("Failed to load activity log:",n)}return[]},r=s("activity_log",c()),g={subscribe:r.subscribe,logEvent(o){const e={...o,id:crypto.randomUUID(),timestamp:new Date().toISOString()};r.update(n=>[e,...n])},getAll(){return a(r)},getByModule(o){return a(r).filter(e=>e.module===o)},getByAction(o){return a(r).filter(e=>e.action===o)},getByDateRange(o,e){return a(r).filter(n=>{const t=new Date(n.timestamp);return t>=o&&t<=e})},search(o){const e=o.toLowerCase();return a(r).filter(n=>n.entityName.toLowerCase().includes(e)?!0:n.changes?n.changes.some(t=>t.field.toLowerCase().includes(e)||String(t.oldValue).toLowerCase().includes(e)||String(t.newValue).toLowerCase().includes(e)):!1)},exportAsJSON(){return JSON.stringify(a(r),null,2)},exportAsCSV(){const o=a(r);if(o.length===0)return"";const e=["Timestamp","Module","Action","Entity Type","Entity Name","User","Changes"],n=o.map(t=>[t.timestamp,t.module,t.action,t.entityType,t.entityName,t.userContext,t.changes?t.changes.map(i=>`${i.field}: ${i.oldValue} â†’ ${i.newValue}`).join("; "):""]);return[e.join(","),...n.map(t=>t.map(i=>`"${String(i).replace(/"/g,'""')}"`).join(","))].join(`
`)},clear(){r.set([])},getTodayCount(){const o=new Date;o.setHours(0,0,0,0);const e=new Date(o);return e.setDate(e.getDate()+1),a(r).filter(n=>{const t=new Date(n.timestamp);return t>=o&&t<e}).length},getStorageSize(){if(typeof window>"u")return 0;const o=localStorage.getItem("continuum_active_account_id")||"anonymous",e=localStorage.getItem(`continuum_acc_${o}_activity_log`);return e?new Blob([e]).size:0}};export{g as a};
