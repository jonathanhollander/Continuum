import{w as d,g as s}from"./DtJFryUL.js";import{a as c}from"./nSX_LeeZ.js";const i=d("owner"),g=d([]),m=[{id:"owner",name:"Original User",role:"Owner",created:Date.now()}],y=(t,e)=>{if(!t)return e;try{return JSON.parse(t)}catch{return e}};typeof localStorage<"u"&&(c.subscribe(t=>{const e=t||"anonymous",o=localStorage.getItem(`continuum_acc_${e}_currentProfileId`)||"owner",n=localStorage.getItem(`continuum_acc_${e}_profiles`),r=y(n||localStorage.getItem("continuum_global_profiles"),m);i.set(o),g.set(r)}),i.subscribe(t=>{const e=s(c)||"anonymous";localStorage.setItem(`continuum_acc_${e}_currentProfileId`,t)}),g.subscribe(t=>{const e=s(c)||"anonymous";t.length>0&&localStorage.setItem(`continuum_acc_${e}_profiles`,JSON.stringify(t))}));const S="http://localhost:8000/api";let u=null;async function p(t){const e=s(c);!e||e==="anonymous"||(u&&clearTimeout(u),u=setTimeout(async()=>{try{console.log("ðŸ”„ Syncing with backend...",t);const o=await fetch(`${S}/estate?user_id=1`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transparent_data:JSON.stringify(t)})});o.ok?console.log("âœ… Sync successful"):console.error("âŒ Sync failed:",o.statusText)}catch(o){console.error("âŒ Sync error:",o)}},2e3))}const f=(t,e,o)=>{if(typeof localStorage>"u")return e;const n=s(c)||"anonymous",r=o||s(i)||"owner",l=`continuum_acc_${n}_prof_${r}_${t}`,a=localStorage.getItem(l);if(a===null)return e;try{return JSON.parse(a)}catch{return a}},_=(t,e,o)=>{if(typeof localStorage>"u")return;const n=s(c)||"anonymous",r=s(i)||"owner",l=`continuum_acc_${n}_prof_${r}_${t}`,a=typeof e=="string"?e:JSON.stringify(e);localStorage.setItem(l,a),n!=="anonymous"&&p({[t]:e})},h=t=>typeof localStorage>"u"?null:localStorage.getItem(t);function w(t,e){const o=d(f(t,e));return typeof localStorage<"u"&&(c.subscribe(n=>{const r=f(t,e);o.set(r)}),i.subscribe(n=>{const r=f(t,e,n);o.set(r)}),o.subscribe(n=>{_(t,n)})),o}export{h as a,i as b,w as c,f as g,g as p,_ as s};
